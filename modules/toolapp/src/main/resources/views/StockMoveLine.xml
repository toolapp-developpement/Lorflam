<?xml version="1.0" encoding="UTF-8"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.4.xsd">

  <form name="stock-move-line-form" title="Stock move line"
    model="com.axelor.apps.stock.db.StockMoveLine" id="custome-stock-move-line-form"
    extension="true">
    <extend target="//field[@name='product']">
      <insert position="after">
        <field name="yard" title="Référence Chantier"
          onChange="action.specifique.method.select.or.create.yard" colSpan="2"/>
      </insert>
    </extend>
    <extend target="//field[@name='unitPriceUntaxed']">
      <insert position="after">
        <spacer/>
        <field name="discountTypeSelect" colSpan="4" onChange="action.stock.move.line.update.discount.price"/>
        <field name="discountAmount" colSpan="4" x-scale="2" onChange="action.stock.move.line.update.discount.price"/>
        <field name="priceDiscounted" colSpan="4" readonly="true"  x-scale="2"/>
      </insert>
    </extend>
  </form>

  <grid name="stock-move-line-grid" title="Stock move line"
    model="com.axelor.apps.stock.db.StockMoveLine" id="custome-stock-move-line-fogridrm"
    extension="true">
    <extend target="//field[@name='unitPriceUntaxed']">
      <insert position="after">
        <field name="discountTypeSelect"
          onChange="action.stock.move.line.update.discount.price, action-invoice-line-attrs-discountamount-title"/>
        <field name="discountAmount" x-scale="2"
          onChange="action.stock.move.line.update.discount.price"/>
        <field name="priceDiscounted" x-scale="2" readonly="true" canEdit="false"/>
      </insert>
    </extend>
  </grid>

  <action-method name="action.stock.move.line.update.discount.price">
    <call method="computeDiscountPrice"
      class="bzh.toolapp.apps.specifique.web.StockMoveLineControllerSpecifique"/>
  </action-method>

  <action-method name="action.specifique.method.select.or.create.yard">
    <call method="selectOrCreateYard(yard)"
      class="bzh.toolapp.apps.specifique.web.PlanificationController"/>
  </action-method>
</object-views>