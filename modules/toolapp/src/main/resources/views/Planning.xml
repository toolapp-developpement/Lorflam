<?xml version="1.0" encoding="UTF-8"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views
  http://axelor.com/xml/ns/object-views/object-views_5.4.xsd">

  <dashboard title="Planning" name="tdb.planning.dashboard">
    <dashlet action="dashlet.planning.orderLines" height="400" colSpan="12" canSearch="true"/>
    <dashlet action="dashlet.planning.stockMoveLines" height="400" colSpan="12"
      canSearch="true"/>
    <dashlet action="dashlet.planning.productionOrders" height="400" colSpan="12"
      canSearch="true"/>
    <dashlet colSpan="12" height="400" action="dashlet.planning.stockMoveLinesCopy"
      canSearch="true"/>
    <dashlet action="dashlet.planning.custMoveLines" height="400" colSpan="12"
      canSearch="true"/>
  </dashboard>

  <action-view name="dashlet.planning.orderLines"
    model="com.axelor.apps.sale.db.SaleOrderLine"
    title="ETAPE 1 SUR 5 : Disponibilité des lignes de commandes">
    <view name="planningOrderLines.grid" type="grid"/>
    <view name="sale-order-line-form" type="form"/>
    <view-param name="limit" value="1000"/>
    <domain>self.estimatedDelivDate IS NOT NULL and self.saleOrder.statusSelect=3</domain>
  </action-view>


  <action-view name="dashlet.planning.stockMoveLines"
    model="com.axelor.apps.stock.db.StockMoveLine"
    title="ETAPE 2 SUR 5 : Disponibilité des lignes de commandes et OF à préparer">
    <view name="planningStockMoveLines.grid" type="grid"/>
    <view name="stock-move-line-all-form" type="form"/>
    <view-param name="limit" value="1000"/>
    <domain>self.stockMove.statusSelect=2 AND self.stockMove.origin>='B'</domain>
  </action-view>

  <action-view name="dashlet.planning.stockMoveLinesCopy"
    model="com.axelor.apps.stock.db.StockMoveLine" title="ETAPE 3 SUR 5 : PLANNING EQUIPE">
    <view name="planningStockMoveLinesTeam.grid" type="grid"/>
    <view name="stock-move-line-all-form" type="form"/>
    <view-param name="limit" value="1000"/>
    <domain>self.stockMove.statusSelect=2 AND self.stockMove.origin>='B'</domain>
  </action-view>

  <action-view name="dashlet.planning.productionOrders"
    model="com.axelor.apps.production.db.ManufOrder"
    title="ETAPE 4 SUR 5 : Liste des ordres de fabrication (en cours)">
    <view name="planningManufOrder.grid" type="grid"/>
    <view name="manuf-order-form" type="form"/>
    <view-param name="limit" value="1000"/>
    <domain>self.statusSelect=3 OR self.statusSelect=4</domain>
  </action-view>

  <action-view name="dashlet.planning.custMoveLines"
    model="com.axelor.apps.stock.db.StockMove" title="ETAPE 5 SUR 5 : BL préparés et à préparer">
    <view name="planningCustMoveLines" type="grid"/>
    <view name="stock-move-calendar" type="calendar"/>
    <view name="stock-move-form" type="form"/>
    <view-param name="limit" value="3000"/>
    <view-param name="forceTitle" value="true"/>
    <view-param name="search-filters" value="customer-deliveries-filters"/>
    <domain> self.typeSelect=2 AND self.statusSelect=2 OR self.statusSelect=5 AND self.typeSelect =
      :_typeSelect AND self.isReversion = FALSE
    </domain>
    <context name="_typeSelect" expr="eval: __repo__(StockMove).TYPE_OUTGOING"/>
    <context name="_isReversion" expr="eval: false"/>
  </action-view>

  <action-view name="planningTeam" title="Planning Equipe" id="planningTeam"
    model="com.axelor.apps.stock.db.StockMoveLine">
    <view type="grid" name="planningStockMoveLinesTeamcustome.grid"/>
    <view type="form" name="stock-move-line-form"/>
    <view-param name="search-filters" value="stock-move-line-planning-filters"/>
    <domain>self.stockMove.statusSelect=2 AND self.stockMove.typeSelect !=3 AND
      self.custSaleOrderSeq !=''</domain>
  </action-view>

  <grid name="planningStockMoveLinesTeamCustome.grid" title="planningStockMoveLinesCopy.grid"
    model="com.axelor.apps.stock.db.StockMoveLine"
    orderBy="custSaleOrderSeq,stockMove.partner,-stockMove.fromStockLocation"
    groupBy="custSaleOrderSeq" edit-icon="false">
    <hilite background="indigo" strong="true"
      if="$get('stockMove.fromStockLocation.name') == 'PRODUCTION'"/>
    <field name="stockMove.estimatedDate" title="Date besoin" hidden="false" width="120"/>
    <field name="custSaleOrderSeq" title="Commande client" hidden="false" width="120"/>
    <field name="saleOrderLine.saleOrder.saleOrderSeq" title="Ligne BL" hidden="true"
      width="100"/>
    <field name="producedManufOrder.saleOrderSet.saleOrderSeq" title="A produire"
      hidden="true" width="100"/>
    <field name="consumedManufOrder.saleOrderSet.saleOrderSeq" title="Ligne OF" hidden="true"
      width="100"/>
    <field name="consumedManufOrder.saleOrderSet.deliveryDate" title="besoin2" hidden="true"
      width="80"/>
    <field name="stockMove.partner" title="Client" width="200"/>
    <field name="yard" title="Référence Chantier" width="200"/>
    <field name="product.defaultBillOfMaterial" hidden="false" width="80"/>
    <field name="stockMove.origin" hidden="false" width="80"/>
    <field name="product.code" title="Code Lorflam" width="350"
      domain="self.dtype = 'Product'" form-view="product-form" grid-view="product-grid"/>
    <field name="product.name" title="Libellé du produit" width="350"
      domain="self.dtype = 'Product'" form-view="product-form" grid-view="product-grid"/>
    <field name="stockMove.fromStockLocation.name" hidden="true" width="200"/>
    <field name="createdOn" hidden="true" width="150"/>
    <field name="name" hidden="true" width="120"/>
    <field name="stockMove.statusSelect" hidden="true" width="80"/>
    <field name="realQty" onChange="action-stock-move-line-group-real-qty-onchange"
      aggregate="sum" x-scale="2"/>
    <field name="unit" width="80" form-view="unit-form" grid-view="unit-grid"/>
    <field name="trackingNumber" hidden="true" domain="self.product = :product"
      form-view="tracking-number-form" grid-view="tracking-number-grid"/>
    <field name="availableQty" title="Stock dispo" hidden="true" width="60"/>
    <field name="product.StockLocationLine.currentQty" title="Stock" hidden="true" width="60"/>
    <field name="availableStatus" width="150">
      <hilite background="success" strong="true" if="availableStatusSelect == 1"/>
      <hilite background="info" strong="true" if="availableStatusSelect == 2"/>
      <hilite background="danger" strong="true" if="availableStatusSelect == 3"/>
      <hilite background="warning" strong="true" if="availableStatusSelect == 4"/>
    </field>
    <field name="stockMove.fromStockLocation" title="De" hidden="true" width="100"/>
    <field name="stockMove.toStockLocation" title="Vers" hidden="true" width="100"/>
    <field name="saleOrderLine.pickingOrderInfo" title="Infos BP" width="200"/>
    <field name="saleOrderLine.saleOrder.carrierPartner" title="Transporteur" width="120"/>
    <field if="__config__.app.getApp('supplychain')?.getManageStockReservation()"
      if-module="axelor-supplychain" name="reservedQty" hidden="true" aggregate="sum" x-scale="2"/>
    <field name="product.productCategory" title="Catégorie de produit" hidden="true"
      width="120"/>
  </grid>


</object-views>